[pytest]
minversion = 6.0

# Add extra strictness and clearer output
addopts =
    -ra
    -q
    --strict-markers
    --strict-config
    --tb=short

# Add extra strictness and clearer output
# addopts =
#     -ra               # Show extra test summary info for failed/skipped/etc.
#     -q                # Quiet output (less noisy)
#     --strict-markers  # Fail on unregistered markers
#     --strict-config   # Fail on misconfigurations
#     --tb=short        # Short traceback style
#     --disable-warnings  # Disable warnings in output (optional)
#     --maxfail=5       # Stop after 5 failures (early feedback in CI or local runs)

# Test discovery
testpaths =
    tests

python_files =
    test_*.py

python_classes =
    Test*

python_functions =
    test_*

# For asyncio support
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function

# Register test markers (for --strict-markers)
markers =
    slow: marks tests as slow (deselect with '-m "not slow"')
    integration: marks tests as integration tests (require external systems)
    unit: marks tests as unit tests (fast and isolated)
    db: marks tests that require database (real or mocked)
    auth: marks tests that test authentication or authorization logic
    security: marks security-related tests like input validation, XSS, SQLi, etc.

# Filter warnings (only ignore specific known ones)
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::pytest.PytestUnraisableExceptionWarning

# Optional: prevent pytest from entering these dirs
norecursedirs =
    .*
    build
    dist
    venv
    migrations
    node_modules
    __pycache__

# Optional: configure cache location explicitly
cache_dir = .pytest_cache
